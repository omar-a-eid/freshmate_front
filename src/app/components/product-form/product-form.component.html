<div class="container mt-5 mb-5">
  <div class="row justify-content-center">
    <div class="col-md-9 col-md-offset-3">
      <div class="card border-0 shadow">
        <div class="card-header bg-dark text-white mb-4">
          <h2 class="mb-0">
            {{ isEditMode ? "Edit Product" : "Add New Product" }}
          </h2>
        </div>
        <div class="card-body">
          <form
            [formGroup]="productForm"
            (ngSubmit)="onSubmit()"
            enctype="multipart/form-data"
          >
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productTitle" i18n
                >Product Title (English):</label
              >
              <input
                type="text"
                class="form-control"
                id="productTitle"
                formControlName="titleEn"
              />
            </div>
            <!--  titleEn validation -->
            <div
              class="form-text text-danger mt-2"
              *ngIf="titleEn.errors?.['required'] && (titleEn.touched || titleEn.dirty)"
            >
              <p i18n><strong>EnglishTitle is Required</strong></p>
            </div>
            <div
              class="form-text text-danger mt-2"
              *ngIf="titleEn.errors?.['minlength'] && (titleEn.touched || titleEn.dirty)"
            >
              <p i18n>
                <strong>EnglishTitle must be at least 5 characters long</strong>
              </p>
            </div>
            <div
              class="form-text text-danger mt-2"
              *ngIf="titleEn.errors?.['maxlength'] && (titleEn.touched || titleEn.dirty)"
            >
              <p i18n>
                <strong>EnglishTitle must be at most 20 characters long</strong>
              </p>
            </div>
            <div
              class="form-text text-danger mt-2"
              *ngIf="titleEn.errors?.['pattern'] && (titleEn.touched || titleEn.dirty)"
            >
              <p i18n>
                <strong
                  >EnglishTitle must be written in english characters
                  only</strong
                >
              </p>
            </div>
            <!-- end titleEn valiadtion -->
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productTitleArabic"
                >Product Title (Arabic):</label
              >
              <input
                type="text"
                class="form-control"
                id="productTitleArabic"
                formControlName="titleAr"
              />
            </div>
            <!--  ArabicTitle validation -->
            <div
              class="form-text text-danger"
              *ngIf="titleAr.errors?.['required'] && (titleAr.touched || titleAr.dirty)"
            >
              <p i18n><strong>ArabicTitle is Required</strong></p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="titleAr.errors?.['minlength'] && (titleAr.touched || titleAr.dirty)"
            >
              <p i18n>
                <strong>ArabicTitle must be at least 5 characters long</strong>
              </p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="titleAr.errors?.['maxlength'] && (titleAr.touched || titleAr.dirty)"
            >
              <p i18n>
                <strong>ArabicTitle must be at most 20 characters long</strong>
              </p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="titleAr.errors?.['pattern'] && (titleAr.touched || titleAr.dirty)"
            >
              <p i18n>
                <strong
                  >ArabicTitle must be written in Arabic characters only</strong
                >
              </p>
            </div>
            <!-- end ArabicTitle valiadtion -->
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productDesc"
                >Product Description (English):</label
              >
              <textarea
                class="form-control"
                id="productDesc"
                formControlName="descEn"
              ></textarea>
            </div>
            <!--  EnglishDescription validation -->
            <div
              class="form-text text-danger"
              *ngIf="descEn.errors?.['required'] && (descEn.touched || descEn.dirty)"
            >
              <p i18n><strong>EnglishDescription is Required</strong></p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="descEn.errors?.['minlength'] && (descEn.touched || descEn.dirty)"
            >
              <p i18n>
                <strong
                  >EnglishDescription must be at least 10 characters
                  long</strong
                >
              </p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="descEn.errors?.['maxlength'] && (descEn.touched || descEn.dirty)"
            >
              <p i18n>
                <strong
                  >EnglishDescription must be at most 50 characters long</strong
                >
              </p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="descEn.errors?.['pattern'] && (descEn.touched || descEn.dirty)"
            >
              <p i18n>
                <strong
                  >EnglishDescription must be written in English characters
                  only</strong
                >
              </p>
            </div>
            <!-- end EnglishDescription valiadtion -->
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productDescArabic"
                >Product Description (Arabic):</label
              >
              <textarea
                class="form-control"
                id="productDescArabic"
                formControlName="descAr"
              ></textarea>
            </div>
            <!--  ArabicDescription validation -->
            <div
              class="form-text text-danger"
              *ngIf="descAr.errors?.['required'] && (descAr.touched || descAr.dirty)"
            >
              <p i18n><strong>ArabicDescription is Required</strong></p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="descAr.errors?.['minlength'] && (descAr.touched || descAr.dirty)"
            >
              <p i18n>
                <strong
                  >ArabicDescription must be at least 10 characters long</strong
                >
              </p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="descAr.errors?.['maxlength'] && (descAr.touched || descAr.dirty)"
            >
              <p i18n>
                <strong
                  >ArabicDescription must be at most 50 characters long</strong
                >
              </p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="descAr.errors?.['pattern'] && (descAr.touched || descAr.dirty)"
            >
              <p i18n>
                <strong
                  >ArabicDescription must be written in Arabic characters
                  only</strong
                >
              </p>
            </div>
            <!-- end ArabicDescription valiadtion -->
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productPrice">Product Price:</label>
              <input
                type="number"
                class="form-control"
                id="productPrice"
                formControlName="price"
              />
            </div>
            <!--  price validation -->
            <div
              class="form-text text-danger"
              *ngIf="price.errors?.['required'] && (price.touched || price.dirty)"
            >
              <p i18n><strong>price is Required</strong></p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="price.errors?.['min'] && (price.touched || price.dirty)"
            >
              <p i18n><strong>price cant be less than zero</strong></p>
            </div>
            <!-- end price valiadtion -->
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productQuantity"
                >Product Quantity:</label
              >
              <input
                type="number"
                class="form-control"
                id="productQuantity"
                formControlName="quantity"
              />
            </div>
            <!--  price validation -->
            <div
              class="form-text text-danger"
              *ngIf="quantity.errors?.['required'] && (quantity.touched || quantity.dirty)"
            >
              <p i18n><strong>quantity is Required</strong></p>
            </div>
            <div
              class="form-text text-danger"
              *ngIf="quantity.errors?.['min'] && (quantity.touched || quantity.dirty)"
            >
              <p i18n><strong>quantity cant be less than zero</strong></p>
            </div>
            <div class="form-group mb-4">
              <label i18n class="mb-3" for="productImage">Product Image:</label>
              <input
                type="file"
                class="form-control-file"
                accept=".jpg,.jpeg,.webp,.png"
                id="productImage"
                (change)="onFileChange($event)"
                name="productImage"
                multiple
              />
              <div
                *ngIf="images.errors?.['required'] && (images.touched || images.dirty)"
                class="text-danger"
                i18n
              >
                Image is required.
              </div>

              <div
                *ngIf="images.errors?.['minlength'] &&(images.touched || images.dirty)"
                class="text-danger"
                i18n
              >
                Minimum 2 images should be uploaded
              </div>
            </div>

            <div
              class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5"
            >
              @for (image of productForm.value.oldImages; track $index) {
              <div class="col mb-3 image_container">
                <div
                  class="btn_container bg-danger"
                  (click)="deleteImage(image)"
                >
                  X
                </div>
                <img
                  src="http://localhost:8000/{{ image }}"
                  alt=""
                  width="100%"
                />
              </div>
              }
              <!-- end images valiadtion -->
            </div>
            <button type="submit" class="btn btn-dark mt-3">
              {{ isEditMode ? "Update Product" : "Add Product" }}
            </button>
            <button
              type="button"
              class="btn btn-danger ml-2"
              *ngIf="isEditMode"
              (click)="onDelete()"
              i18n
            >
              Delete Product
            </button>
            <p *ngIf="message" class="mt-3">{{ message }}</p>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
